# Funcionalidade de EdiÃ§Ã£o de TransaÃ§Ãµes

## VisÃ£o Geral

Permite editar ou excluir transaÃ§Ãµes diretamente da tela de Faturas do CartÃ£o de CrÃ©dito, facilitando correÃ§Ãµes e ajustes quando necessÃ¡rio.

## Como Usar

### 1. Acessar a EdiÃ§Ã£o

Na tabela de transaÃ§Ãµes, ao passar o mouse sobre uma linha, um Ã­cone de ediÃ§Ã£o (âœï¸) aparece no canto direito:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Netflix Premium â”‚ 15/11 â”‚ Lazer â”‚ Recorrente â”‚ R$ 49,90 [âœï¸] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â†‘
                                                   Aparece ao hover
```

### 2. Modal de EdiÃ§Ã£o

Ao clicar no Ã­cone, abre um modal com todos os campos editÃ¡veis:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Editar TransaÃ§Ã£o                                  [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  CartÃ£o: Nubank                                        â”‚
â”‚  Final 1234                                            â”‚
â”‚  âš ï¸ Esta Ã© uma assinatura recorrente                   â”‚
â”‚                                                        â”‚
â”‚  Valor *                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ R$ 49,90                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  Categoria *                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Lazer                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  Estabelecimento                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Netflix                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  DescriÃ§Ã£o                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Netflix Premium                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  Data *                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 2025-11-15                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Excluir  â”‚  â”‚ Cancelar â”‚  â”‚ Salvar           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Campos EditÃ¡veis

### 1. Valor

- MÃ¡scara de moeda automÃ¡tica (R$ 0,00)
- Funciona da segunda casa decimal
- ValidaÃ§Ã£o: deve ser maior que zero

### 2. Categoria

- Dropdown com categorias predefinidas:
  - AlimentaÃ§Ã£o
  - Transporte
  - SaÃºde
  - EducaÃ§Ã£o
  - Lazer
  - Compras
  - ServiÃ§os
  - Viagem
  - Outros

### 3. Estabelecimento

- Campo de texto livre
- Opcional
- Exemplo: "Netflix", "Supermercado Extra"

### 4. DescriÃ§Ã£o

- Campo de texto multilinha
- Opcional
- Exemplo: "Netflix Premium", "Compras do mÃªs"

### 5. Data

- Seletor de data
- ObrigatÃ³rio
- Formato: YYYY-MM-DD

## Avisos Especiais

### Assinatura Recorrente

```
âš ï¸ Esta Ã© uma assinatura recorrente
```

Indica que a transaÃ§Ã£o Ã© uma assinatura que se repete mensalmente.

### Parcela

```
âš ï¸ Parcela 3 de 12
```

Indica que a transaÃ§Ã£o faz parte de um parcelamento.

## Funcionalidade de ExclusÃ£o

### 1. BotÃ£o Excluir

Localizado no canto inferior esquerdo do modal:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—‘ Excluir â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ConfirmaÃ§Ã£o de ExclusÃ£o

Ao clicar em "Excluir", aparece uma confirmaÃ§Ã£o:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Tem certeza que deseja excluir esta transaÃ§Ã£o?     â”‚
â”‚                                                        â”‚
â”‚  Esta aÃ§Ã£o nÃ£o pode ser desfeita.                     â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Cancelar â”‚  â”‚ Confirmar ExclusÃ£o               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. ExclusÃ£o Confirmada

ApÃ³s confirmar:

- TransaÃ§Ã£o Ã© removida do banco de dados
- Fatura Ã© recalculada automaticamente
- Lista de transaÃ§Ãµes Ã© atualizada
- Modal Ã© fechado

## Casos de Uso

### Caso 1: Corrigir Valor Errado

**SituaÃ§Ã£o:** Digitou R$ 49,90 mas era R$ 59,90

**Passos:**

1. Clicar no Ã­cone de ediÃ§Ã£o
2. Alterar o valor para R$ 59,90
3. Clicar em "Salvar"

**Resultado:**

- Valor atualizado na fatura
- Total da fatura recalculado

### Caso 2: Mudar Categoria

**SituaÃ§Ã£o:** Categorizou como "Lazer" mas deveria ser "EducaÃ§Ã£o"

**Passos:**

1. Clicar no Ã­cone de ediÃ§Ã£o
2. Selecionar "EducaÃ§Ã£o" no dropdown
3. Clicar em "Salvar"

**Resultado:**

- Categoria atualizada
- Badge na tabela reflete a nova categoria

### Caso 3: Adicionar DescriÃ§Ã£o

**SituaÃ§Ã£o:** TransaÃ§Ã£o sem descriÃ§Ã£o clara

**Passos:**

1. Clicar no Ã­cone de ediÃ§Ã£o
2. Adicionar descriÃ§Ã£o detalhada
3. Clicar em "Salvar"

**Resultado:**

- DescriÃ§Ã£o aparece na tabela
- Facilita identificaÃ§Ã£o futura

### Caso 4: Reembolso Recebido

**SituaÃ§Ã£o:** Compra foi reembolsada pelo estabelecimento

**Passos:**

1. Clicar no Ã­cone de ediÃ§Ã£o
2. Clicar em "Excluir"
3. Confirmar exclusÃ£o

**Resultado:**

- TransaÃ§Ã£o removida da fatura
- Total da fatura reduzido
- Limite disponÃ­vel aumentado

### Caso 5: Duplicata

**SituaÃ§Ã£o:** TransaÃ§Ã£o foi lanÃ§ada duas vezes por engano

**Passos:**

1. Identificar a duplicata
2. Clicar no Ã­cone de ediÃ§Ã£o na duplicata
3. Clicar em "Excluir"
4. Confirmar exclusÃ£o

**Resultado:**

- Duplicata removida
- Apenas uma transaÃ§Ã£o permanece

### Caso 6: Data Incorreta

**SituaÃ§Ã£o:** Data da transaÃ§Ã£o estÃ¡ errada

**Passos:**

1. Clicar no Ã­cone de ediÃ§Ã£o
2. Alterar a data
3. Clicar em "Salvar"

**Resultado:**

- Data atualizada
- TransaÃ§Ã£o pode mudar de fatura se a data cruzar o fechamento

## API Endpoints

### PATCH /api/transactions/:id

Atualiza uma transaÃ§Ã£o existente.

**Request:**

```json
{
  "amount": 59.9,
  "category": "EducaÃ§Ã£o",
  "description": "Curso online",
  "merchant": "Udemy",
  "date": "2025-11-15"
}
```

**Response:**

```json
{
  "success": true,
  "data": {
    "$id": "trans_123",
    "amount": 59.9,
    "category": "EducaÃ§Ã£o",
    "description": "Curso online",
    "merchant": "Udemy",
    "date": "2025-11-15T00:00:00.000Z",
    "updated_at": "2025-10-29T12:00:00.000Z"
  }
}
```

### DELETE /api/transactions/:id

Exclui uma transaÃ§Ã£o.

**Response:**

```json
{
  "success": true,
  "message": "Transaction deleted successfully"
}
```

## ValidaÃ§Ãµes

### Valor

- âœ… Deve ser maior que zero
- âœ… MÃ¡ximo de 2 casas decimais
- âŒ NÃ£o pode ser negativo
- âŒ NÃ£o pode ser vazio

### Categoria

- âœ… Deve ser uma das categorias predefinidas
- âŒ NÃ£o pode ser vazia

### Data

- âœ… Deve ser uma data vÃ¡lida
- âœ… Formato ISO 8601
- âŒ NÃ£o pode ser vazia

### Estabelecimento e DescriÃ§Ã£o

- âœ… Podem ser vazios (opcionais)
- âœ… Texto livre

## Comportamento Especial

### Assinaturas Recorrentes

Ao editar uma assinatura recorrente:

- âš ï¸ Aviso especial Ã© exibido
- Apenas a transaÃ§Ã£o atual Ã© editada
- PrÃ³ximas cobranÃ§as mantÃªm os valores originais
- Para alterar todas as futuras, edite a transaÃ§Ã£o original (primeira)

### Parcelas

Ao editar uma parcela:

- âš ï¸ Aviso especial mostra qual parcela Ã©
- Apenas a parcela atual Ã© editada
- Outras parcelas nÃ£o sÃ£o afetadas
- Para alterar todas, edite cada uma individualmente

### ExclusÃ£o de Assinatura

Ao excluir uma assinatura recorrente:

- Apenas a transaÃ§Ã£o atual Ã© excluÃ­da
- PrÃ³ximas cobranÃ§as continuam sendo criadas
- Para cancelar a assinatura, exclua a transaÃ§Ã£o original

### ExclusÃ£o de Parcela

Ao excluir uma parcela:

- Apenas a parcela atual Ã© excluÃ­da
- Outras parcelas nÃ£o sÃ£o afetadas
- Total parcelado nÃ£o Ã© recalculado

## SincronizaÃ§Ã£o

### Saldo da Conta

Ao editar ou excluir uma transaÃ§Ã£o:

- Saldo da conta Ã© recalculado automaticamente
- Limite disponÃ­vel do cartÃ£o Ã© atualizado
- MudanÃ§as refletem imediatamente

### Fatura

Ao editar ou excluir uma transaÃ§Ã£o:

- Total da fatura Ã© recalculado
- Subtotais das seÃ§Ãµes sÃ£o atualizados
- Lista de transaÃ§Ãµes Ã© recarregada

## Estados de Loading

### Salvando

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Salvando...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Excluindo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Excluindo...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Mensagens de Erro

### Erro ao Salvar

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Erro ao atualizar transaÃ§Ã£o                        â”‚
â”‚  O valor deve ser maior que zero                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Erro ao Excluir

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Erro ao excluir transaÃ§Ã£o                          â”‚
â”‚  TransaÃ§Ã£o nÃ£o encontrada                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Acessibilidade

- **Hover State:** Ãcone de ediÃ§Ã£o aparece ao passar o mouse
- **Keyboard:** Pode ser acessado via Tab
- **Screen Readers:** BotÃ£o tem atributo `title` descritivo
- **Focus:** Estados de foco visÃ­veis em todos os campos
- **ConfirmaÃ§Ã£o:** ExclusÃ£o requer confirmaÃ§Ã£o explÃ­cita

## SeguranÃ§a

- **AutenticaÃ§Ã£o:** Apenas usuÃ¡rio autenticado pode editar
- **AutorizaÃ§Ã£o:** Apenas transaÃ§Ãµes do prÃ³prio usuÃ¡rio
- **ValidaÃ§Ã£o:** Todos os campos sÃ£o validados no backend
- **ConfirmaÃ§Ã£o:** ExclusÃ£o requer confirmaÃ§Ã£o dupla

## Performance

- **OtimizaÃ§Ã£o:** Apenas transaÃ§Ã£o editada Ã© recarregada
- **Cache:** Lista de transaÃ§Ãµes Ã© atualizada localmente
- **Debounce:** NÃ£o aplicado (aÃ§Ã£o Ãºnica ao salvar)
- **Loading States:** Feedback visual durante operaÃ§Ãµes

## Testes

### Teste 1: Editar Valor

1. Abrir modal de ediÃ§Ã£o
2. Alterar valor de R$ 49,90 para R$ 59,90
3. Salvar
4. Verificar que valor foi atualizado na tabela

### Teste 2: Excluir TransaÃ§Ã£o

1. Abrir modal de ediÃ§Ã£o
2. Clicar em "Excluir"
3. Confirmar exclusÃ£o
4. Verificar que transaÃ§Ã£o foi removida

### Teste 3: Cancelar EdiÃ§Ã£o

1. Abrir modal de ediÃ§Ã£o
2. Alterar campos
3. Clicar em "Cancelar"
4. Verificar que nada foi alterado

### Teste 4: ValidaÃ§Ã£o de Valor

1. Abrir modal de ediÃ§Ã£o
2. Tentar salvar com valor zero
3. Verificar mensagem de erro

### Teste 5: Editar Assinatura

1. Editar uma assinatura recorrente
2. Verificar aviso especial
3. Salvar alteraÃ§Ãµes
4. Verificar que apenas a transaÃ§Ã£o atual foi alterada
